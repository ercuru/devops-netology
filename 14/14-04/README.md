# Домашнее задание к занятию «Обновление приложений»

### Цель задания

Выбрать и настроить стратегию обновления приложения.

-----

<details><summary>  Чеклист готовности к домашнему заданию </summary>

Кластер K8s.
</details>

<details><summary>  Инструменты и дополнительные материалы, которые пригодятся для выполнения задания </summary>

1. [Документация Updating a Deployment](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#updating-a-deployment).
2. [Статья про стратегии обновлений](https://habr.com/ru/companies/flant/articles/471620/).
</details>
<details><summary> Правила приёма работы </summary>

1. Домашняя работа оформляется в своём Git-репозитории в файле README.md. Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.
2. Файл README.md должен содержать скриншоты вывода необходимых команд, а также скриншоты результатов.
3. Репозиторий должен содержать тексты манифестов или ссылки на них в файле README.md.
</details>

-----

### Задание 1. Выбрать стратегию обновления приложения и описать ваш выбор

>1. Имеется приложение, состоящее из нескольких реплик, которое требуется обновить.
>2. Ресурсы, выделенные для приложения, ограничены, и нет возможности их увеличить.
>3. Запас по ресурсам в менее загруженный момент времени составляет 20%.
>4. Обновление мажорное, новые версии приложения не умеют работать со старыми.
>5. Вам нужно объяснить свой выбор стратегии обновления приложения.

Исходя что новая версия приложения не работает со старыми и есть ограничения по выделению ресурсов для обновления использовал бы **Recreate**

Плюсы:
- скорость перехода на новую версию
- нет превышения по используемым ресурсам
- нет одновременной работы двух версий (если требуется перейти одномоментно)

Минусы:
- наличие простоя

### Задание 2. Обновить приложение

>1. Создать deployment приложения с контейнерами nginx и multitool. Версию nginx взять 1.19. Количество реплик — 5.

- Cоздали манифест [deployment](deployment.yaml)
- развернули
<p align="center">
  <img  src=".//scr/1.jpg">
</p>

- видим первую версию в истории
<p align="center">
  <img  src=".//scr/2.jpg">
</p>

>2. Обновить версию nginx в приложении до версии 1.20, сократив время обновления до минимума. Приложение должно быть доступно.
- меняем версию в манифесте и применяем
<p align="center">
  <img  src=".//scr/3.jpg">
</p>

>3. Попытаться обновить nginx до версии 1.28, приложение должно оставаться доступным.
- меняем на некорректную версию и пробуем применить
<p align="center">
  <img  src=".//scr/4.jpg">
</p>

>4. Откатиться после неудачного обновления.
- откатываемся
<p align="center">
  <img  src=".//scr/5.jpg">
</p>
